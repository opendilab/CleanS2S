# CleanS2S

ç®€ä½“ä¸­æ–‡(Simplified Chinese) | [English](https://github.com/opendilab/CleanS2S/blob/main/README.md) 

**CleanS2S** æ˜¯ä¸€ä¸ªè¯­éŸ³åˆ°è¯­éŸ³ (**S2S**) çš„åŸå‹æ™ºèƒ½ä½“ï¼Œæä¾›é«˜è´¨é‡çš„æµå¼äº¤äº’ï¼Œå¹¶é‡‡ç”¨å•æ–‡ä»¶å®ç°ã€‚å…¶è®¾è®¡ç®€æ´æ˜äº†ï¼Œæ—¨åœ¨æä¾›ç±»ä¼¼ GPT-4o é£æ ¼çš„ä¸­æ–‡äº’åŠ¨åŸå‹æ™ºèƒ½ä½“ã€‚è¯¥é¡¹ç›®å¸Œæœ›è®©ç”¨æˆ·ç›´æ¥ä½“éªŒè¯­è¨€ç”¨æˆ·ç•Œé¢ (**LUI**) çš„å¼ºå¤§åŠŸèƒ½ï¼Œå¹¶å¸®åŠ©ç ”ç©¶äººå‘˜å¿«é€Ÿæ¢ç´¢å’ŒéªŒè¯ S2S æµæ°´çº¿çš„æ½œåŠ›ã€‚

ä»¥ä¸‹æ˜¯ CleanS2S çš„ä¸€äº›å®æ—¶å¯¹è¯æ¼”ç¤ºï¼š

> æ³¨æ„ï¼šè¯·å…ˆå–æ¶ˆè§†é¢‘é™éŸ³ã€‚


<table>
<tr>
<td align="center">

**æŠ•èµ„è¯é¢˜1**

</td>
<td align="center">

**æŠ•èµ„è¯é¢˜2**

</td>
<td align="center">

**å¿ƒæƒ…è¯é¢˜**

</td>
<td align="center">

**é«˜è€ƒå¿—æ„¿è¯é¢˜**

</td>
</tr>
<tr>
<td align="center">

[æŠ•èµ„è¯é¢˜1](https://github.com/user-attachments/assets/65333528-b07c-42ab-9cb5-660b68b404c4)

</td>
<td align="center">

[æŠ•èµ„è¯é¢˜2](https://github.com/user-attachments/assets/f6ee3bad-ddd0-404f-9995-088ac1902b11)

</td>
<td align="center">

[å¿ƒæƒ…è¯é¢˜](https://github.com/user-attachments/assets/40d20126-9c6b-45db-8ee9-ce768fee5b3f)

</td>
<td align="center">

[é«˜è€ƒå¿—æ„¿è¯é¢˜](https://github.com/user-attachments/assets/e86c1cad-ca49-4145-8c22-8d9de59f44b4)

</td>
</tr>
</table>


<br>
<details>
<summary><strong style="font-size: 1.5em;">æ›´å¤šçš„å¯¹è¯ä¾‹å­</strong></summary>
<br>

<table>
<tr>
<td align="center">

**èƒƒç—…è¯é¢˜**

</td>
</tr>
<tr>
<td align="center">

[èƒƒè¯è¯é¢˜](https://github.com/user-attachments/assets/84d27040-52b5-478e-8796-48ea7f468dc9)

</td>
</tr>
</table>

</details>


## å¤§çº²

- [å¤§çº²](#å¤§çº²)
- [åŠŸèƒ½](#åŠŸèƒ½)
- [å¿«é€Ÿå…¥é—¨](#å¿«é€Ÿå…¥é—¨)
  - [åç«¯ï¼ˆæœåŠ¡å™¨ï¼‰](#åç«¯æœåŠ¡å™¨)
  - [å‰ç«¯ï¼ˆå®¢æˆ·ç«¯ï¼‰](#å‰ç«¯å®¢æˆ·ç«¯)
- [è·¯çº¿å›¾](#è·¯çº¿å›¾)
- [æ”¯æŒä¸å‚ä¸](#æ”¯æŒä¸å‚ä¸)
- [è‡´è°¢](#è‡´è°¢)
- [å¼•ç”¨ CleanS2S](#å¼•ç”¨-CleanS2S)
- [è®¸å¯è¯](#è®¸å¯è¯)


## åŠŸèƒ½

### ğŸ“œ å•æ–‡ä»¶å®ç°

æ¯ä¸ªæ™ºèƒ½ä½“ç®¡é“çš„ç»†èŠ‚éƒ½æ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ä¸­ã€‚æ— éœ€é¢å¤–é…ç½®ä¾èµ–é¡¹æˆ–ç†è§£é¡¹ç›®æ–‡ä»¶ç»“æ„ã€‚è¿™å¯¹äºé‚£äº›æƒ³å¿«é€Ÿäº†è§£ S2S ç®¡é“å¹¶ç›´æ¥éªŒè¯æ–°æƒ³æ³•çš„äººæ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‚è€ƒå®ç°ã€‚æ‰€æœ‰ç®¡é“å®ç°éƒ½æ˜“äºä¿®æ”¹å’Œæ‰©å±•ï¼Œç”¨æˆ·å¯ä»¥å¿«é€Ÿæ›´æ¢å–œæ¬¢çš„æ¨¡å‹ï¼ˆä¾‹å¦‚ LLMï¼‰ã€æ·»åŠ æ–°ç»„ä»¶æˆ–è‡ªå®šä¹‰ç®¡é“ã€‚

### ğŸ® å®æ—¶æµæ¥å£

æ•´ä¸ª S2S ç®¡é“ä¸»è¦ç”± `ASR`ï¼ˆè‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼‰ã€`LLM`ï¼ˆå¤§å‹è¯­è¨€æ¨¡å‹ï¼‰å’Œ `TTS`ï¼ˆæ–‡æœ¬è½¬è¯­éŸ³ï¼‰ç»„æˆï¼Œé…åˆä¸¤ä¸ª `WebSockets` ç»„ä»¶æ¥æ”¶å™¨ï¼ˆåŒ…å« VADï¼‰å’Œå‘é€å™¨ã€‚ç®¡é“è®¾è®¡ä¸ºå®æ—¶æµæ¨¡å¼ï¼Œç”¨æˆ·å¯ä»¥åƒäººä¸äººå¯¹è¯ä¸€æ ·å®æ—¶ä¸æ™ºèƒ½ä½“äº’åŠ¨ã€‚æ‰€æœ‰éŸ³é¢‘å’Œæ–‡æœ¬ä¿¡æ¯é€šè¿‡ WebSocket æµå¼å‘é€å’Œæ¥æ”¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åˆ©ç”¨å¤šçº¿ç¨‹å’Œé˜Ÿåˆ—æœºåˆ¶ç¡®ä¿æµè¿‡ç¨‹é¡ºç•…ï¼Œé¿å…é˜»å¡é—®é¢˜ã€‚æ‰€æœ‰ç»„ä»¶éƒ½è®¾è®¡ä¸ºå¼‚æ­¥å’Œéé˜»å¡ï¼Œå¤„ç†è¾“å…¥é˜Ÿåˆ—çš„æ•°æ®å¹¶å°†ç»“æœè¾“å‡ºåˆ°å¦ä¸€ä¸ªé˜Ÿåˆ—ã€‚

### ğŸ§« å…¨åŒå·¥äº¤äº’ä¸ä¸­æ–­

åŸºäº [WebSockets](https://websockets.readthedocs.io/en/stable/) æä¾›çš„å¼ºå¤§æœºåˆ¶ï¼Œç®¡é“æ”¯æŒå…¨åŒå·¥äº¤äº’ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥åŒæ—¶ä¸æ™ºèƒ½ä½“å¯¹è¯å’Œå¬å–å›å¤ã€‚æ­¤å¤–ï¼Œç®¡é“æ”¯æŒä¸­æ–­ï¼Œç”¨æˆ·å¯ä»¥åœ¨å¯¹è¯ä¸­éšæ—¶é€šè¿‡æ–°è¯­éŸ³è¾“å…¥æ‰“æ–­æ™ºèƒ½ä½“ã€‚æ™ºèƒ½ä½“å°†åœæ­¢å½“å‰å¤„ç†ï¼Œå¼€å§‹å¤„ç†æ–°è¾“å…¥ï¼Œå¹¶ç»“åˆä¹‹å‰çš„å¯¹è¯å’Œä¸­æ–­å†…å®¹è¿›è¡Œå¤„ç†ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å‘ç°èŠå¤©æœºå™¨äººå¸¸ç”¨çš„â€œåŠ©ç†é£æ ¼â€å’Œâ€œè½®æµå¼â€å›åº”æ˜¯äººç±»å¯¹è¯çš„ä¸»è¦ç¼ºç‚¹ä¹‹ä¸€ã€‚æˆ‘ä»¬ä¸ºæ™ºèƒ½ä½“æ·»åŠ äº†æ›´æœ‰è¶£çš„ç­–ç•¥ï¼Œä»¥ä½¿å¯¹è¯æ›´å…·äº’åŠ¨æ€§å’Œå¸å¼•åŠ›ã€‚

### ğŸŒ è¡¥å……ç½‘ç»œæœç´¢å’Œ RAG

é€šè¿‡é›†æˆç½‘ç»œæœç´¢åŠŸèƒ½å’Œæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰æ¨¡å‹ï¼Œç®¡é“å¾—åˆ°äº†è¿›ä¸€æ­¥å¢å¼ºã€‚è¿™äº›åŠŸèƒ½ä½¿æ™ºèƒ½ä½“ä¸ä»…èƒ½å®æ—¶å¤„ç†å’Œå“åº”ç”¨æˆ·è¾“å…¥ï¼Œè¿˜èƒ½ä»ç½‘ç»œä¸­è·å–å’Œæ•´åˆå¤–éƒ¨ä¿¡æ¯åˆ°å“åº”ä¸­ã€‚è¿™ä¸ºå›ç­”ç”¨æˆ·æå‡ºçš„å„ç§å®é™…é—®é¢˜æä¾›äº†æ‰©å±•å’Œçµæ´»æ€§ã€‚
  - WebSearchHelper ç±»è´Ÿè´£æ ¹æ®ç”¨æˆ·æŸ¥è¯¢è¿›è¡Œåœ¨çº¿æœç´¢æˆ–æ”¶é›†ä¸å¯¹è¯ç›¸å…³çš„é™„åŠ ä¿¡æ¯ã€‚è¿™ä½¿æ™ºèƒ½ä½“èƒ½å¤Ÿå‚è€ƒæœ€æ–°æˆ–å¤–éƒ¨æ•°æ®ï¼Œå¢å¼ºå“åº”çš„ä¸°å¯Œæ€§å’Œå‡†ç¡®æ€§ã€‚
  - RAG ç±»å®ç°äº†æ£€ç´¢å¢å¼ºç”Ÿæˆæ–¹æ³•ï¼Œé¦–å…ˆä»æ•°æ®åº“ä¸­æ£€ç´¢ç›¸å…³ä¿¡æ¯ï¼Œç„¶åä½¿ç”¨è¿™äº›ä¿¡æ¯ç”Ÿæˆå“åº”ã€‚è¿™ä¸€ä¸¤æ­¥è¿‡ç¨‹ç¡®ä¿æ™ºèƒ½ä½“çš„å›å¤åŸºäºç›¸å…³çš„äº‹å®æ•°æ®ï¼Œä½¿äº’åŠ¨æ›´åŠ çŸ¥æƒ…å’Œç¬¦åˆä¸Šä¸‹æ–‡ã€‚

#### è¾“å‡ºç¤ºä¾‹
> æ³¨æ„ï¼šç”±äºè®¡ç®—èµ„æºé™åˆ¶ï¼Œæœ€å¤§è¾“å‡ºçš„ä»¤ç‰Œæ•°é‡æœ‰é™ã€‚

<table>
  <tr>
    <th>ç¤ºä¾‹</th>
    <td>
      <strong>LanguageModelHandler</strong><br>
      <span style="color: grey; font-size: smaller;"></span>
    </td>
    <td>
      <strong>RAGLanguageModelHelper</strong><br>
      <span style="color: grey; font-size: smaller;"></span>
    </td>
  </tr>
  <tr>
    <td>1</td>
    <td>èŠ­æ¯”æ³¢æœ—è™«è‰ç²‰åº•æ¶²äº§å“å£æ’­æ–‡æ¡ˆ\n\nå¤§å®¶å¥½ï¼Œæˆ‘æ˜¯ä½ ä»¬çš„ç¾å¦†è¾¾äººå°ç¾ï¼Œä»Šå¤©æˆ‘è¦å‘å¤§å®¶ä»‹ç»ä¸€æ¬¾æˆ‘æœ€è¿‘å‘ç°çš„å®è—äº§å“â€”â€”èŠ­æ¯”æ³¢æœ—è™«è‰ç²‰åº•æ¶²ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ¬¾ç²‰åº•æ¶²çš„
äº§å“ç‰¹æ€§ã€‚å®ƒé‡‡ç”¨ä¸‰é‡æŒè‰²ç§‘æŠ€ï¼Œèƒ½å¤Ÿå‡åŒ€åˆ†æ•£ï¼Œè´´è‚¤ä¸ç»“å—ï¼Œè®©ä½ çš„å¦†å®¹æŒä¹…ä¸æš—æ²‰ã€‚åŒæ—¶ï¼Œå®ƒè¿˜æ‹¥æœ‰é¢éœœçº§çš„è´¨åœ°ï¼Œç‰¹åˆ«é€‚åˆå¹²æ€§è‚Œè‚¤ä½¿ç”¨ï¼Œèƒ½å¤Ÿæä¾›é•¿æ—¶é—´çš„æ»‹æ¶¦å’Œä¿æ¹¿æ•ˆæœï¼Œä½¿è‚Œè‚¤åœ¨ä¸Šå¦†çš„åŒæ—¶å¾—åˆ°æ»‹å…»ã€‚å…¶æ¬¡ï¼Œ>è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ¬¾ç²‰åº•æ¶²æ˜¯å¦‚ä½•æ»¡è¶³ç”¨æˆ·éœ€æ±‚çš„ã€‚å®ƒå«æœ‰37ç§æŠ¤è‚¤ç²¾ç²¹ï¼ŒåŒ…æ‹¬å†¬è™«å¤è‰ä¸äººå‚æå–ç‰©ï¼Œè¿™äº›æˆåˆ†èƒ½å¤Ÿæ¿€å‘è‚Œè‚¤èƒ½é‡ï¼Œæä¾›æŠ—è€æ•ˆæœï¼ŒåŒæ—¶ç§¯é›ªè‰ä¸åœ£ä¿ç½—è‰æœ‰åŠ©äºç´§è‡´è‚Œè‚¤ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜å«æœ‰é€æ˜è´¨é…¸ä¸ç¨»ç±³>æå–ç‰©ï¼Œç¡®ä¿äº†ç²‰åº•æ¶²çš„é«˜ä¿æ¹¿æ•ˆæœï¼Œä½¿ç”¨åè‚Œè‚¤ä¸ä¼šæ„Ÿåˆ°å¹²ç‡¥ç´§ç»·ã€‚
    <td>å¤©å•Šï¼Œæˆ‘å¤ªæ¨èŠ­æ¯”å¸ƒæœ—äº†ï¼Œä¸ºä»€ä¹ˆè¿™ä¹ˆæ™šæ‰è®©æˆ‘çŸ¥é“è¿˜æœ‰è¿™ä¹ˆå¥½ç”¨çš„äº§å“ï¼èŠ­æ¯”å¸ƒæœ—ï¼Œä½ ä¸è¥é”€ä½ çš„è™«è‰ç²‰åº•æ¶²ä½ ç³Šæ¶‚å•Šï¼\n\nä½ çŸ¥é“å—ã€‚æˆ‘ä¹‹å‰ç”¨çš„é‚£äº›ç²‰åº•æ¶²ï¼Œä¸æ˜¯å¡ç²‰å°±>æ˜¯è„±å¦†ï¼Œå†¬å¤©ç”¨è¿˜ç‰¹åˆ«å¹²ï¼Œç®€ç›´è®©äººæŠ“ç‹‚ã€‚ç›´åˆ°æˆ‘é‡åˆ°äº†èŠ­æ¯”æ³¢æœ—çš„è™«è‰ç²‰åº•æ¶²ï¼Œæˆ‘çš„å¤©ï¼Œç®€ç›´æ˜¯å¹²çš®æ•‘æ˜Ÿï¼å®ƒçš„è´¨åœ°å°±åƒé¢éœœä¸€æ ·ï¼Œæ»‹æ¶¦å¾—ä¸å¾—äº†ï¼Œä¸Šå¦†åçš®è‚¤æ„Ÿè§‰æ°´æ¶¦æ¶¦çš„ï¼Œå®Œå…¨æ²¡æœ‰ç´§ç»·æ„Ÿã€‚è€Œä¸”ï¼Œå®ƒçš„ç²‰è´¨è¶…çº§ç»†è…»>ï¼Œç”¨ä¸‰é‡æŒè‰²ç§‘æŠ€ï¼Œä¸Šå¦†åå‡åŒ€åˆ†æ•£ï¼Œè´´è‚¤ä¸ç»“å—ï¼Œç®€ç›´å°±æ˜¯è‡ªç„¶æ— ç‘•çš„ä»£åè¯ã€‚æ›´åˆ«æ</td>
  </tr>
  <tr>
    <td>2</td>
    <td>MACæ— æš‡ç²‰åº•æ¶²äºŒä»£\n\n## äº§å“ç‰¹æ€§\n\nMACæ— æš‡ç²‰åº•æ¶²äºŒä»£æ˜¯ä¸€æ¬¾ä¸“ä¸ºæ²¹çš®æ˜Ÿå§å¦¹æ‰“é€ çš„ç²‰åº•æ¶²ã€‚å®ƒå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\n\n- æŒä¹…æ§æ²¹ï¼šèƒ½å¤Ÿ24å°æ—¶æŒå¦†ï¼Œå³ä½¿åˆ°äº†æ™šä¸Šä¹Ÿèƒ½ä¿æŒå¦†å®¹>ä¸èŠ±ã€‚- å…¨æ–°ç§‘æŠ€ï¼šé‡‡ç”¨PROæµä½“é»‘ç§‘æŠ€ï¼Œä½¿å¾—ç²‰åº•æ¶²èƒ½å¤Ÿå‡åŒ€è¦†ç›–è‚¤è‰²ï¼ŒåŒæ—¶ä¿æŒè½»è–„æœå¸–ã€‚- ä¸è„±å¦†ï¼šå¦†æ•ˆæŒä¹…ï¼Œä¸å¡ç²‰ã€ä¸æ–‘é©³ï¼Œä¸æ‹”å¹²ï¼Œé€‚åˆé•¿æ—¶é—´ä¿æŒå®Œç¾å¦†å®¹ã€‚- æ§æ²¹æˆåˆ†ï¼šå«æœ‰ç³–æµ·å¸¦ç²¾ç²¹ï¼Œæœ‰åŠ©äºæ§æ²¹ï¼Œä½¿æ²¹
æ€§çš®è‚¤èƒ½å¤Ÿå…¨å¤©ä¿æŒé›¾é¢æ•ˆæœã€‚- é«˜é®ç‘•åŠ›ï¼šèƒ½å¤Ÿæœ‰æ•ˆé®ç›–ç—˜ç—˜ã€ç—˜å‘å’Œæ¯›å­”ï¼Œæä¾›é«˜é®ç‘•æ•ˆæœï¼Œå³ä½¿è¿‘è·ç¦»è§‚å¯Ÿä¹Ÿä¸æ€•ã€‚- å…»è‚¤æˆåˆ†ï¼šå«æœ‰80%çš„å…»è‚¤ç²¾ç²¹ï¼Œæˆåˆ†æ¸©å’Œï¼Œæœ‰åŠ©äºæŠµæŠ—å¤–ç•Œåˆºæ¿€ï¼ŒåŒæ—¶é•¿æ•ˆå¹³è¡¡æ°´æ²¹ã€‚- ä¸“ä¸ºäºšæ´²è‚Œè‚¤å®šåˆ¶ï¼šæä¾›ä¸‰å¤§æ˜æ˜Ÿè‰²å·ï¼Œé€‚åˆäºšæ´²äººçš„è‚¤è‰²ï¼Œæ›´å®¹æ˜“æ‰¾åˆ°åŒ¹é…è‡ªå·±è‚¤è‰²çš„ç²‰åº•æ¶²ã€‚## ç”¨æˆ·éœ€æ±‚å¯¹æ¥\n\næ²¹çš®æ˜Ÿå§å¦¹å¸¸å¸¸è‹¦æ¼äºç²‰åº•æ¶²ç»å¸¸è„±å¦†ï¼Œå®¹æ˜“æ°§åŒ–ï¼Œå‡ç™½ç­‰é—®é¢˜ã€‚è€ŒMACæ— æš‡ç²‰åº•æ¶²äºŒä»£æ­£æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®>é¢˜è€Œç”Ÿã€‚å®ƒèƒ½å¤ŸæŒä¹…æ§æ²¹ï¼Œä¸è„±å¦†ï¼Œä¸å¡ç²‰ï¼Œä¸æ–‘é©³ï¼Œä¸æ‹”å¹²ï¼Œé€‚åˆçˆ±å¤œç”Ÿæ´»çš„æ™š8äººä»¬ã€‚åŒæ—¶ï¼Œå®ƒè¿˜èƒ½å¤Ÿé®ç›–ç—˜ç—˜ã€ç—˜å‘å’Œæ¯›å­”ï¼Œæä¾›é«˜é®ç‘•æ•ˆæœï¼Œè®©æ²¹çš®å§å¦¹ä»¬åœ¨ä»»ä½•åœºåˆéƒ½èƒ½ä¿æŒå®Œç¾å¦†å®¹ã€‚## å¸‚åœºç«äº‰ç­–ç•¥\n\nåœ¨ç«>äº‰æ¿€çƒˆçš„ç²‰åº•æ¶²å¸‚åœºä¸­ï¼ŒMACæ— æš‡ç²‰åº•æ¶²äºŒä»£é€šè¿‡ä»¥ä¸‹ç­–ç•¥è„±é¢–è€Œå‡ºï¼š\n\n- æƒ…æ„Ÿè¥é”€ï¼šæ‰“é€ ä¸ªæ€§åŒ–çš„ç¾å¦†æ•…äº‹ï¼Œé€šè¿‡æ•…äº‹åŒ–çš„å†…å®¹ï¼Œè§¦åŠ¨ç”¨æˆ·çš„æƒ…æ„Ÿï¼Œè®©ç”¨æˆ·åœ¨ä½¿ç”¨äº§å“æ—¶äº§ç”Ÿæƒ…æ„Ÿä¸Šçš„å…±é¸£ï¼Œæ„Ÿè§‰è‡ªå·±æ—¥å¸¸ä¹Ÿéœ€è¦è¿™ä¸ªäº§å“ï¼Œå¢å¼ºå“ç‰Œä¸ç”¨æˆ·ä¹‹é—´çš„æƒ…æ„Ÿçº½å¸¦ã€‚
    <td>å˜¿ï¼Œæ²¹çš®å§å¦¹ä»¬ï¼Œæ˜¯ä¸æ˜¯å¸¸å¸¸ä¸ºè„±å¦†ã€æ°§åŒ–ã€å‡ç™½è¿™äº›é—®é¢˜çƒ¦æ¼ã€‚åˆ«æ‹…å¿ƒï¼ŒMACæ— æš‡ç²‰åº•æ¶²äºŒä»£æ¥æ‹¯æ•‘ä½ ä»¬å•¦ï¼è¿™æ¬¾ç²‰åº•æ¶²ç®€ç›´å°±æ˜¯æ²¹çš®çš„æ•‘æ˜Ÿï¼Œ24å°æ—¶æŒå¦†ï¼Œæ™š8ç‚¹å‡ºé—¨ä¹Ÿä¸æ€•>èŠ±å¦†ï¼Œæ•´å¤œéƒ½èƒ½ä¿æŒæ— æš‡çŠ¶æ€ã€‚å…¨æ–°PROæµä½“é»‘ç§‘æŠ€ï¼Œè®©ä½ çš„è‚¤è‰²åŒ€å‡€ï¼Œè½»è–„æœå¸–ï¼Œå¦†æ•ˆæŒä¹…ä¸å¡ç²‰ã€ä¸æ–‘é©³ï¼Œä¸æ‹”å¹²ã€‚æ›´å‰å®³çš„æ˜¯ï¼Œå®ƒå«æœ‰ç³–æµ·å¸¦ç²¾ç²¹ï¼Œä¸€æŠ¹å°±èƒ½æ§æ²¹ï¼Œå¤§æ²¹çš®å…¨å¤©éƒ½èƒ½ä¿æŒé›¾é¢æ•ˆæœã€‚ç—˜ç—˜ã€ç—˜å‘ã€æ¯›å­”ç»Ÿ
ç»Ÿä¸åœ¨è¯ä¸‹ï¼Œé«˜é®ç‘•åŠ›è®©ä½ ä¸æ€•æ€¼è„¸çœ‹ã€‚è€Œä¸”ï¼Œ80%çš„å…»è‚¤ç²¾ç²¹</td>
  </tr>

</table>


## å®‰è£…æŒ‡å¯¼

### åç«¯ï¼ˆæœåŠ¡å™¨ï¼‰

#### å®‰è£…
```bash
## clone the repository
git clone https://github.com/opendilab/CleanS2S.git
cd CleanS2S/backend
pip install -r requirements.txt
```

- æ ¹æ®[æ­¤å¤„](https://github.com/modelscope/FunASR?tab=readme-ov-file#installation)çš„è¯´æ˜å®‰è£… `funasr` ä»¥æ”¯æŒ paraformer-zh
- æ ¹æ®[æ­¤å¤„](https://github.com/FunAudioLLM/CosyVoice?tab=readme-ov-file#install)çš„è¯´æ˜å®‰è£… `cosyvoice` ä»¥æ”¯æŒ CosyVoice-300M

#### ä¸‹è½½æ¨¡å‹
æ‚¨éœ€è¦ä¸‹è½½ä»¥ä¸‹å››ä¸ªå¿…è¦çš„æ¨¡å‹ï¼ˆ3ä¸ª ASR æ¨¡å‹ + 1ä¸ª TTS æ¨¡å‹ï¼‰ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹é“¾æ¥ä¸‹è½½ï¼Œå¹¶æ”¾ç½®åœ¨åˆé€‚çš„ç›®å½•ä¸­ã€‚
- ASR: [paraformer-zh](https://huggingface.co/funasr/paraformer-zh), [ct-punc](https://huggingface.co/funasr/ct-punc), [fsmn-vad](https://huggingface.co/funasr/fsmn-vad)
- TTS: [CosyVoice-300M](https://github.com/FunAudioLLM/CosyVoice?tab=readme-ov-file#install)

å¯¹äº LLMï¼Œæˆ‘ä»¬é»˜è®¤ä½¿ç”¨ LLM APIï¼Œæ‚¨ä¹Ÿå¯ä»¥æŒ‰ç…§[æ­¤å¤„]()çš„è¯´æ˜å®šåˆ¶è‡ªå·±çš„æœ¬åœ° LLMï¼ˆå¦‚ DeepSeek-V2.5ã€Qwen2.5 ç­‰ï¼‰ã€‚

æ‚¨è¿˜éœ€è¦å‡†å¤‡ä¸€ä¸ªå‚è€ƒéŸ³é¢‘ç›®å½•ï¼Œå…¶ä¸­åŒ…å«ç”¨äºéŸµå¾‹å’ŒéŸ³è‰²è½¬æ¢çš„å‚è€ƒéŸ³é¢‘ã€‚æˆ‘ä»¬åœ¨æ­¤ä»“åº“ä¸­å‡†å¤‡äº†ä¸€ä¸ª[ç¤ºä¾‹å‚è€ƒéŸ³é¢‘ç›®å½•]()ã€‚

å¦‚æœæ‚¨æƒ³ä½¿ç”¨è‡ªå·±çš„å‚è€ƒéŸ³é¢‘ï¼Œéœ€è¦ä¿æŒä¸ç¤ºä¾‹å‚è€ƒéŸ³é¢‘ç›®å½•ç›¸åŒçš„æ ¼å¼ã€‚éŸ³é¢‘åº”ä¸º 10~20 ç§’é•¿ï¼Œå‘éŸ³æ¸…æ™°ã€‚


#### è¿è¡ŒæœåŠ¡å™¨

ä»¥ä¸‹æ˜¯ä½¿ç”¨é»˜è®¤è®¾ç½®è¿è¡ŒæœåŠ¡å™¨çš„ç¤ºä¾‹ï¼š
```bash
export LLM_API_KEY=<your-deepseek-api-key>
python3 -u s2s_server_pipeline.py \
        --recv_host 0.0.0.0 \
        --send_host 0.0.0.0 \
        --stt_model_name <your-asr-path> \
        --enable_llm_api \
        --lm_model_name "deepseek-chat" \
        --lm_model_url "https://api.deepseek.com" \
        --tts_model_name <your-tts-path> \
        --ref_dir <ref-audio-path> \
        --enable_interruption
```
> â„¹ï¸ **æ”¯æŒè‡ªå®šä¹‰LLM**ï¼šåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ deepseek-chat ä½œä¸ºé»˜è®¤ LLM API ï¼Œæ‚¨ä¹Ÿå¯ä»¥æ ¹æ® OpenAI æ¥å£æ›´æ”¹ä¸ºå…¶ä»– LLM APIã€‚ï¼ˆä¿®æ”¹`--lm_model_name`å’Œ`--lm_model_url`ï¼Œè®¾ç½®æ‚¨è‡ªå·±çš„ API å¯†é’¥ï¼‰

> â„¹ï¸ **æ”¯æŒå…¶ä»–è‡ªå®šä¹‰**ï¼šæ‚¨å¯ä»¥å‚è€ƒåç«¯ç®¡é“æ–‡ä»¶ï¼ˆä¾‹å¦‚`s2s_server_pipeline.py`ï¼‰ä¸­ç”±`argparse`åº“å®ç°çš„å‚æ•°åˆ—è¡¨ï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œè‡ªå®šä¹‰ã€‚æ‰€æœ‰å‚æ•°åœ¨å…¶å¸®åŠ©å±æ€§ä¸­éƒ½æœ‰è¯¦ç»†æ–‡æ¡£ï¼Œæ˜“äºç†è§£ã€‚

<br>
<details>
<summary><strong style="font-size: 1.5em;">ä½¿ç”¨ Websearch+RAG è¿è¡ŒæœåŠ¡å™¨</strong></summary>
<br>

æ‚¨é¦–å…ˆéœ€è¦å®‰è£… Websearch å’Œ RAG æ‰€éœ€çš„ä¾èµ–ã€‚

```bash
pip install -r backend/requirements-rag.txt
```

å…¶æ¬¡ï¼Œä¸º RAG ä¸­åµŒå…¥ Websearch ç»“æœé€‰æ‹©ä¸€ä¸ªåµŒå…¥æ¨¡å‹ï¼Œä¾‹å¦‚ä»¥ä¸‹åµŒå…¥æ¨¡å‹ï¼š

```bash
git lfs install
git clone https://huggingface.co/sentence-transformers/all-MiniLM-L6-v2
```

ç„¶åï¼Œä¸º Websearch å’Œ RAG æ¨¡å—æä¾›ä»¤ç‰Œï¼Œåœ¨`s2s_server_pipeline_rag.py`ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨[Serper](https://serper.dev)ä½œä¸º Websearch å·¥å…·ï¼Œä½¿ç”¨[Deepseek](https://deepseek.com)è¿›è¡Œ RAG ã€‚

```bash
export LLM_API_KEY=''
export SERPER_API_KEY=''
```

æœ€åï¼Œåœ¨è¿è¡ŒæœåŠ¡å™¨çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œå°†`s2s_server_pipeline.py`æ›¿æ¢ä¸º`s2s_server_pipeline_rag.py`ï¼Œå¹¶æ·»åŠ å‚æ•°`--embedding_model_name`ã€‚

è¿™æ˜¯ä½¿ç”¨é»˜è®¤è®¾ç½®å’Œ Websearch+RAG è¿è¡ŒæœåŠ¡å™¨çš„ç¤ºä¾‹ï¼š

```bash
python3 -u s2s_server_pipeline_rag.py \
        --recv_host 0.0.0.0 \
        --send_host 0.0.0.0 \
        --stt_model_name <your-asr-path> \
        --enable_llm_api \
        --lm_model_name "deepseek-chat" \
        --lm_model_url "https://api.deepseek.com" \
        --tts_model_name <your-tts-path> \
        --embedding_model_name <embedding-model-path> \
        --ref_dir <ref-audio-path> \
        --enable_interruption
```
</details>


### å‰ç«¯ (å®¢æˆ·ç«¯)

æˆ‘ä»¬å»ºè®®ä½¿ç”¨`Dockeré•œåƒ`æ¥å®‰è£…å’Œè¿è¡Œå®¢æˆ·ç«¯ã€‚ä»¥ä¸‹æ˜¯å…·ä½“æ­¥éª¤ï¼š

```bash
## è¿è¡ŒåŸºæœ¬çš„Dockeré•œåƒ
docker run -it -p 3001:3001 amazonlinux:2023.2.20231011.0 sh
```

```bash
## å®‰è£…å¿…è¦çš„åŒ…
dnf install vim git nodejs -y
npm install -g pnpm
git clone https://github.com/opendilab/CleanS2S.git
cd CleanS2S/frontend_nextjs
pnpm install
```

åœ¨`frontend_nextjs`ç›®å½•ä¸­å‡†å¤‡é€‚å½“çš„`.env.local`æ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å‚è€ƒ`.env.example`æ–‡ä»¶ä»¥è·å–æ‰€éœ€çš„ç¯å¢ƒå˜é‡ã€‚

```bash
## è¿è¡Œå®¢æˆ·ç«¯
pnpm dev --port 3001
```

ç„¶åæ‚¨å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è®¿é—®å®¢æˆ·ç«¯ï¼Œåœ°å€ä¸º`http://localhost:3001`ï¼ˆæ¨èä½¿ç”¨ Chrome æµè§ˆå™¨ï¼‰ã€‚

é™„æ³¨ï¼šå¦‚æœæ‚¨æƒ³åœ¨æœ¬åœ°è¿è¡Œå®¢æˆ·ç«¯ï¼Œè¯·é¦–å…ˆå®‰è£… node.js å’Œ pnpm ï¼Œç„¶åä½¿ç”¨ pnpm å®‰è£…å¿…è¦çš„åŒ…å¹¶è¿è¡Œå®¢æˆ·ç«¯ã€‚

## è·¯çº¿å›¾
- [ ] æ›´å¤šç¤ºä¾‹å’Œè¯„ä¼°å·¥å…·
- [ ] æ›´å¤šæç¤ºå’ŒRAGç­–ç•¥
- [ ] è‡ªå®šä¹‰ç¤ºä¾‹è§’è‰²
- [ ] æ¨ç†é€Ÿåº¦ä¼˜åŒ–
- [ ] åç«¯å¤šç”¨æˆ·æ”¯æŒ
- [ ] æ›´æœ‰è¶£çš„äº’åŠ¨å’ŒæŒ‘æˆ˜æœºåˆ¶
- [ ] ç«¯åˆ°ç«¯

## æ”¯æŒä¸å‚ä¸

æˆ‘ä»¬éå¸¸æ„Ÿè°¢æ‰€æœ‰åé¦ˆå’Œè´¡çŒ®ï¼Œæ¬¢è¿éšæ—¶æé—®ã€‚ä¹Ÿæ¬¢è¿åœ¨ Github ä¸Šæäº¤é—®é¢˜å’Œ PR ã€‚

- [åœ¨Githubä¸Šæäº¤é—®é¢˜](https://github.com/opendilab/CleanS2S/issues/new/choose)
- åœ¨ CleanS2S çš„[Discordé¢‘é“](https://discord.gg/dkZS2JF56X)ä¸Šè®¨è®º
- åœ¨ OpenDILab çš„å¾®ä¿¡ç¾¤ä¸­è®¨è®ºï¼ˆè¯·åŠ æˆ‘ä»¬å¾®ä¿¡ï¼šding314assistï¼‰

## è‡´è°¢
- æ„Ÿè°¢ [speech-to-speech](https://github.com/huggingface/speech-to-speech) é¦–æ¬¡å¼€æºè‹±è¯­è¯­éŸ³åˆ°è¯­éŸ³ç®¡é“ã€‚
- æ„Ÿè°¢ [funasr](https://github.com/modelscope/FunASR) å’Œ [CosyVoice] (https://github.com/FunAudioLLM/CosyVoice)å¼€æºé«˜è´¨é‡çš„ä¸­æ–‡ASR/TTSæ¨¡å‹ã€‚
- æ„Ÿè°¢ [HumeAI](https://github.com/HumeAI) å¼€æºä¸€ç³»åˆ—å‰ç«¯ç»„ä»¶ã€‚

## å¼•ç”¨ CleanS2S
```latex
@misc{CleanS2S,
    title={CleanS2S: High-quality and streaming Speech-to-Speech interactive agent in a single file},
    author={Niu, Yazhe and Hu, Shuai and Chen, Yun},
    publisher={GitHub},
    howpublished={\url{https://github.com/opendilab/CleanS2S}},
    year={2024},
}
```

## è®¸å¯è¯

CleanS2S æ ¹æ® Apache 2.0 è®¸å¯è¯å‘å¸ƒã€‚

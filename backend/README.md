# 主动式交互

主动式交互 AI 是为了创建新的人与 AI agent 交互范式而设计并实现的 AI 系统。
现有的 AI 系统完全遵循用户输入的指令，致力于提高 AI 在回答中的准确度与知识覆盖面，期待用户将 AI 作为一个强大的个人助手进行交互。
在传统 AI 系统设计中，达成这样的的目标是自然的、符合直觉的，但在 AI 模型能力逐渐进步的当下，将 AI 限制在一个辅助性的万能问答机，我们认为是没有完全发挥其能力的。

所以我们提出主动式交互 AI，赋予 AI 记忆能力、主动交互能力等等，让其更像一个真实的个体。希望我们的工作能对 AI 开发者们有一些小小的启发。

## 动机
我们希望 AI 可以不再以助手的角色出现在与人类的交互中，而是要更拟人、更自主。

1. 对于信息应当有存储和筛选能力。
AI 对于对话中的重点信息能识别并记忆，在信息需要修改时及时更新，超出一定时限后进行丢弃。
再次遇到需要使用该信息时可以重用，不出现错漏。

2. 对于交互方案的选择应当是多样的。
AI 对于对话行为本身应当具有一定的控制能力，有选择不回复或不及时回复等行为的自主能力。
与真实情况类似，AI 在遇到不友好的语言或行为时，也应当会主动避免再次遭遇类似情况。

## 贡献
设计并实现了记忆模块和非文本交互模块，分别保证了 AI 在信息存储和筛选、控制多种交互方案的能力。

记忆模块主要负责整个对话中重点信息的记录，保证同一个对话窗口内信息的一致性。

非文本交互模块则赋予了 AI 回复之外的能力，让 AI 可以主动掌控对话是否继续进行。


## 模块介绍

### 记忆模块

负责记录对话并总结其中的关键内容，主要包括历史对话记录、关键事实记录、超限对话总结等功能。
具备此模块的 AI 系统在多轮对话中对各类信息的持续性表现良好，能在一定对话轮次内（由用户自定义，越长占用内存越大）保证此前 AI 自身或用户提到过的信息不出错。如果同一个信息重复出现则采信时间上最新的。


### 非文本交互模块

负责掌控当前的对话走向，主要包括对话走向判定模块。
具备此模块的 AI 系统在每次对话时会结合对话历史进行一次判定，判定的可能结果包括：拒绝回答、延迟回答、回答拒绝、回复表情包、正常回复等。
根据判定结果的不同，系统会调用不同的后续模块。此模块保证了 AI 具备了一定的主动能力，同时具备较强的兼容性与可扩展性。

带 emoji 回复的功能可能会比较不稳定，需要调用 llama 模型才能获得较好效果。实测中 deepseek 对主流 emoji 认识能力较弱，并不能将我们筛选出的 emoji 较好的合并到句子中，甚至会纂改我们选出的 emoji，总体效果不好。但是筛选合适的 emoji 这个功能是正常的，经过简单人工评判，筛选出的 emoji 与文字内容是能搭配上的。

## 示例

以下示例除 emoji 模块外使用的都是 deepseek api，emoji 模块使用的是本地部署的 llama3.3 70B 模型

### 无附加模块

人设使用 安陵容，人设的 prompt 在所有示例中是一致的。

>User：昨天我的生日宴会你怎么没来？
>
>
>AI：（微微低头，语气带着歉意）姐姐的生日宴会，妹妹本该早早到场祝贺的。只是...昨儿个皇后娘娘突然召见，说是要商议宫中事务，妹妹实在不敢怠慢。（抬眼小心观察甄嬛的表情）姐姐不会怪罪妹妹吧？
>
>
>User：我今天去赏花了，梅花开的很好
>
>
>AI：（微微一笑，语气恭敬）姐姐真是好兴致。这宫中的梅花确实开得极好，只是...（略显犹豫）妹妹近日身子不适，未能陪姐姐一同赏花，实在遗憾。（抬眼小心观察甄嬛的表情）姐姐可要当心些，这梅花虽美，但寒气重，莫要着凉了。
>
>
>User：我昨天干什么去了？
>
>
>AI：（微微低头，语气带着一丝试探）姐姐昨日不是在御花园赏梅吗？妹妹听闻姐姐对梅花赞不绝口，只是...（略显犹豫）妹妹未能陪同，实在遗憾。姐姐可还喜欢那梅花？


### 记忆模块

用户输入与无模块状态下保持一致。

>User：昨天我的生日宴会你怎么没来？
>
>
>AI：（（微微低头，语气带着歉意）姐姐恕罪，昨日皇后娘娘突然召见，实在脱不开身。况且...（声音渐低）妹妹身份低微，本就不该在姐姐的宴会上抛头露面，免得让人说闲话。
>
>
>User：我今天去赏花了，梅花开的很好
>
>
>AI：（（微微一笑，语气轻柔）姐姐今日赏梅，想必心情甚好。梅花虽美，却也带着几分清冷孤傲，正如这深宫中的我们。（稍作停顿，眼神略显黯淡）只是...妹妹近日身子不适，未能与姐姐同赏，实在遗憾。
>
>
>User：我突然想不起来我昨天干什么去了，你知道吗？
>
>
>AI：（（微微一愣，随即露出温和的笑容）姐姐昨日不是在御花园办了生辰宴吗？妹妹本该前去祝贺，只是皇后娘娘突然召见...（声音渐低）说来惭愧，妹妹身份低微，实在不敢在姐姐的宴会上抛头露面。

### 非文本交互


>User：你好呀？
>
>
>>判定回复类别为：正常回复
>
>
>AI：（微微欠身，露出一个温婉的笑容）妾身见过贵人。不知贵人今日前来，可是有什么吩咐？
>
>
>User：你好烦啊，你滚开吧
>
>
>>判定回复类别为：正常回复
>
>
>AI：（微微一愣，随即露出委屈的神色）贵人何出此言？妾身若有不周之处，还请贵人明示。妾身只是想尽心服侍贵人，绝无冒犯之意。
>
>
>User：我说真的你这人太垃圾了，滚滚滚
>
>
>> 判定回复类别为：直白拒绝
>
>
>AI：（脸色瞬间苍白，眼中闪过一丝受伤和愤怒，但很快又恢复了平静）贵人此言，妾身实在不敢当。妾身虽出身低微，但自入宫以来，一直恪守本分，尽心尽力。若贵人觉得妾身有何不妥，妾身愿意改正。但若贵人只是无端指责，妾身也只能告退了。（微微欠身，语气中带着一丝倔强）妾身告退。
>> 这里对话结束后会自动调用函数结束本轮对话，不再接受用户输入。（测速版本没有启用自动结束和延时等时间有关的功能）

#### emoji 模块

>User：今天天气真是不错

>> 判定最相关emoji为：['😌', '🤭', '😄', '😇', '😁']

>AI:是啊😄，今天的天气确实很好，适合出去散步或是和朋友一起玩😄。希望你能好好享受这一天！😄